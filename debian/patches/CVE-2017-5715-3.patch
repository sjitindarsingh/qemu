Backport of:

From a2381f0934432ef2cd47a335348ba8839632164c Mon Sep 17 00:00:00 2001
From: Eduardo Habkost <ehabkost@redhat.com>
Date: Tue, 9 Jan 2018 13:45:15 -0200
Subject: [PATCH] i386: Add spec-ctrl CPUID bit

Add the feature name and a CPUID_7_0_EDX_SPEC_CTRL macro.

Signed-off-by: Eduardo Habkost <ehabkost@redhat.com>
Message-Id: <20180109154519.25634-4-ehabkost@redhat.com>
Signed-off-by: Eduardo Habkost <ehabkost@redhat.com>
---
 target/i386/cpu.c | 2 +-
 target/i386/cpu.h | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

Index: qemu-2.5+dfsg/target-i386/cpu.c
===================================================================
--- qemu-2.5+dfsg.orig/target-i386/cpu.c	2018-01-23 08:37:26.925477474 -0500
+++ qemu-2.5+dfsg/target-i386/cpu.c	2018-01-23 08:38:13.949660831 -0500
@@ -274,7 +274,7 @@ static const char *cpuid_7_0_edx_feature
     NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
     NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
     NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
-    NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
+    NULL, NULL, "spec-ctrl", NULL, NULL, NULL, NULL, NULL,
 };
 
 static const char *cpuid_apm_edx_feature_name[] = {
Index: qemu-2.5+dfsg/target-i386/cpu.h
===================================================================
--- qemu-2.5+dfsg.orig/target-i386/cpu.h	2018-01-23 08:37:26.925477474 -0500
+++ qemu-2.5+dfsg/target-i386/cpu.h	2018-01-23 08:38:45.069776604 -0500
@@ -587,6 +587,7 @@ typedef uint32_t FeatureWordArray[FEATUR
 #define CPUID_7_0_EBX_AVX512PF (1U << 26) /* AVX-512 Prefetch */
 #define CPUID_7_0_EBX_AVX512ER (1U << 27) /* AVX-512 Exponential and Reciprocal */
 #define CPUID_7_0_EBX_AVX512CD (1U << 28) /* AVX-512 Conflict Detection */
+#define CPUID_7_0_EDX_SPEC_CTRL     (1U << 26) /* Speculation Control */
 
 #define CPUID_XSAVE_XSAVEOPT   (1U << 0)
 #define CPUID_XSAVE_XSAVEC     (1U << 1)
